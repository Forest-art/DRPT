import torch
import numpy as np
import torch.nn as nn
import math
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm


##  =A1&","&A2&","&A3&","&A4&","&A5&","&A6&","&A7&","&A8&","&A9&","&A10&","&A11&","&A12&","&A13&","&A14&","&A15&","&A16&","&A17&","&A18&","&A19&","&A20&","&A21&","&A22


font_path = '/usr/share/fonts/fonts/Arial Bold.ttf'
fm.fontManager.addfont(font_path)
# plt.rcParams['font.family'] = fm.FontProperties(fname=font_path).get_name()
new_font = fm.FontProperties(fname=font_path)


##### UT-Zappos
# ivr_se = [0,0.0205378973105134,0.143031784841075,0.238386308068459,0.324938875305623,0.40122249388753,0.440097799511002,0.4760391198044,0.495843520782396,0.515647921760391,0.528117359413202,0.537652811735941,0.544254278728606,0.549388753056234,0.554523227383863,0.563325183374083,0.566259168704156,0.567726161369193,0.568459657701711,0.570660146699266,0.569926650366748,0.572127139364303]
# ivr_un = [0.656771799628942,0.654545454545454,0.622263450834879,0.589981447124304,0.557699443413729,0.52430426716141,0.49090909090909,0.458627087198515,0.42634508348794,0.392949907235621,0.360667903525046,0.328385899814471,0.296103896103896,0.261595547309833,0.230426716141001,0.197031539888682,0.164749536178107,0.131354359925788,0.0979591836734694,0.0656771799628942,0.0322820037105751,0]
# plt.plot(ivr_se,ivr_un, 'go-', label="IVR (30.6)")


# compcos_se = [0,0.00660146699266503,0.0931540342298288,0.191442542787286,0.278728606356968,0.319070904645476,0.349877750611246,0.393887530562347,0.432762836185819,0.465036674816625,0.498044009779951,0.519315403422982,0.539853300733496,0.545721271393642,0.555990220048899,0.564792176039119,0.569926650366748,0.573594132029339,0.578728606356968,0.580195599022004,0.582396088019559,0.582396088019559]
# compcos_un = [0.615584415584415,0.613358070500927,0.582189239332096,0.552133580705009,0.519851576994434,0.489795918367346,0.459740259740259,0.429684601113172,0.398515769944341,0.36734693877551,0.337291280148422,0.306122448979591,0.276066790352504,0.244897959183673,0.213729128014842,0.182560296846011,0.151391465677179,0.122448979591836,0.0912801484230055,0.0601113172541744,0.0300556586270872,0]
# plt.plot(compcos_se,compcos_un, 'co-', label="CompCos (28.7)")


# le_se = [0,0.0242053789731051,0.176772616136919,0.258924205378973,0.316136919315403,0.364547677261613,0.399755501222493,0.41882640586797,0.446699266503667,0.451833740831295,0.470171149144254,0.481173594132029,0.489975550122249,0.503911980440097,0.509046454767726,0.516381418092909,0.520048899755501,0.528117359413202,0.530317848410757,0.533251833740831,0.539119804400978,0.539853300733496]
# le_un = [0.50204081632653,0.495361781076066,0.470871985157699,0.447495361781076,0.421892393320964,0.396289424860853,0.370686456400742,0.348423005565862,0.323933209647495,0.29721706864564,0.273840445269016,0.248237476808905,0.222634508348794,0.198144712430426,0.173654916512059,0.149165120593692,0.12356215213358,0.0990723562152133,0.0723562152133581,0.0489795918367347,0.0222634508348793,0]
# plt.plot(le_se,le_un, 'mo-', label="LE+ (25.7)")


# csp_se = [0.63734114, 0.63636363, 0.63538611, 0.63245356, 0.63049853, 0.6285435,
#  0.62365592, 0.62170088, 0.61583579, 0.60997069, 0.60312808, 0.58064514,
#  0.54740959, 0.51221895, 0.46725318, 0.40664712, 0.33822092, 0.26881722,
#  0.18377322, 0.11534702, 0.04496579, 0.        ]
# csp_un = [0.,         0.03278688, 0.06610259, 0.09994712, 0.13008989, 0.16446325,
#  0.19989423, 0.2321523,  0.26652566, 0.29825488, 0.33315706, 0.36647275,
#  0.39978847, 0.43310419, 0.46536225, 0.49814913, 0.53305131, 0.56530935,
#  0.59915388, 0.63246959, 0.66631413, 0.67318881]
# plt.plot(csp_se,csp_un, 'ro-', label="CSP (33.0)")


# drpt_se = [0.6529814,  0.6529814,  0.65102637, 0.64907134, 0.64613879, 0.64320624,
#  0.64027369, 0.63440859, 0.62952101, 0.62658846, 0.61290324, 0.60215056,
#  0.58944279, 0.58357769, 0.56891495, 0.54447705, 0.51612902, 0.47214076,
#  0.4056696,  0.32551318, 0.11143695, 0.        ]
# drpt_un = [0.,         0.03331571, 0.06663141, 0.0994183,  0.132734,   0.16552089,
#  0.19777896, 0.23320994, 0.26599681, 0.29666844, 0.33262825, 0.36435747,
#  0.39714438, 0.42993125, 0.4643046,  0.49920678, 0.53040719, 0.56583816,
#  0.59862506, 0.63299841, 0.66578531, 0.67160231]
# plt.plot(drpt_se,drpt_un, 'bo-', label="DRPT (37.9)")



# plt.xlabel("seen_accuracy", font = new_font)
# plt.ylabel("unseen_accuracy", font = new_font)
# plt.title('UT-Zappos50K', font = new_font)
# plt.legend(prop = new_font)   #打上标签
# plt.savefig('demos/AUC-UT.pdf', dpi=300)





##### CGQA
ivr_se = [0,0.0872324159021406,0.125229357798165,0.145030581039755,0.161085626911315,0.171788990825688,0.176605504587155,0.195336391437308,0.208180428134556,0.221559633027522,0.229587155963302,0.23440366972477,0.244571865443425,0.252064220183486,0.261162079510703,0.263302752293577,0.265443425076452,0.268654434250764,0.269724770642201,0.271330275229357,0.272400611620795,0.272400611620795, 0.2729357798165137, 0.2734709480122324, 0.2729357798165137]
ivr_un = [0.0999590834697217,0.0953764320785597,0.0907937806873977,0.0867839607201309,0.0822013093289689,0.0776186579378068,0.0733224222585924,0.069026186579378,0.0647299509001636,0.059860883797054,0.0558510638297872,0.0512684124386252,0.0469721767594107,0.042962356792144,0.0383797054009819,0.0343698854337152,0.030646481178396,0.0263502454991816,0.0220540098199672,0.0174713584288052,0.0131751227495908,0.0085924713584288, 0.008592471358428805, 0.004296235679214416, 0]
plt.plot(ivr_se,ivr_un, 'go-', label="IVR (2.2)")


compcos_se = [0.000535168195718652,0.0117737003058103,0.0759938837920489,0.106498470948012,0.1348623853211,0.176070336391437,0.19854740061162,0.210321100917431,0.219954128440366,0.236009174311926,0.252599388379204,0.257415902140672,0.272935779816513,0.283639143730886,0.293272171253822,0.295948012232415,0.297018348623853,0.299159021406727,0.301834862385321,0.303440366972477,0.304510703363914,0.30611620795107,0.307186544342507,0.306651376146788,0.308256880733944]
compcos_un = [0.121726677577741,0.120294599018003,0.115425531914893,0.110270049099836,0.105114566284779,0.0990998363338788,0.0945171849427168,0.0890752864157119,0.0842062193126022,0.079050736497545,0.07360883797054,0.0681669394435351,0.0632978723404255,0.0578559738134206,0.0509819967266775,0.0469721767594107,0.0421031096563011,0.0369476268412438,0.0317921440261865,0.0266366612111293,0.0209083469721767,0.0157528641571194,0.0108837970540098,0.00544189852700488,0]
plt.plot(compcos_se,compcos_un, 'co-', label="CompCos (2.9)")


scen_se = [-0.000535168195718652,0.0775993883792048,0.113455657492354,0.140214067278287,0.163761467889908,0.191590214067278,0.207645259938837,0.215672782874617,0.223165137614678,0.235474006116207,0.242966360856269,0.248318042813455,0.257951070336391,0.265443425076452,0.274541284403669,0.285244648318042,0.295948012232415,0.299694189602446,0.303975535168195,0.30611620795107,0.307186544342507,0.309327217125382,0.309327217125382]
scen_un = [0.132896890343698,0.128600654664484,0.122299509001636,0.116284779050736,0.110270049099836,0.104255319148936,0.098240589198036,0.0922258592471358,0.085924713584288,0.0793371522094926,0.07360883797054,0.0673076923076923,0.0612929623567921,0.0549918166939443,0.0489770867430441,0.042962356792144,0.0366612111292962,0.0303600654664484,0.0246317512274959,0.0183306055646481,0.0120294599018003,0.00630114566284778,-0.000286415711947624]
plt.plot(scen_se,scen_un, 'mo-', label="SymNet (3.1)")


csp_se = [0.27440566, 0.27389985, 0.27339402, 0.27314112, 0.27061203, 0.26960039,
 0.26808295, 0.26428932, 0.26024279, 0.25366718, 0.24734446, 0.24001011,
 0.23216996, 0.2215478,  0.21168438, 0.20283258, 0.18917552, 0.16388467,
 0.1378351,  0.107739,   0.04527061, 0.        ]
csp_un = [0.,         0.01223776, 0.02622378, 0.03933566, 0.05244755, 0.06468531,
 0.07867133, 0.09178322, 0.10314685, 0.11800699, 0.13111888, 0.14335664,
 0.15559441, 0.1687063,  0.1826923,  0.19580419, 0.20979021, 0.2229021,
 0.23601398, 0.24825175, 0.26223776, 0.27097902]
plt.plot(csp_se,csp_un, 'ro-', label="CSP (5.9)")


drpt_se = [0.29160345, 0.29109761, 0.290086,   0.28983307, 0.28705108, 0.28426909,
 0.28199291, 0.27819929, 0.27339402, 0.27162367, 0.26125443, 0.25518462,
 0.24405666, 0.23039959, 0.21648963, 0.2005564,  0.18184118, 0.15123925,
 0.12620132, 0.09028832, 0.03844208, 0.        ]
drpt_un = [0.,         0.01398601, 0.0270979,  0.04195804, 0.05594406, 0.06905594,
 0.08391608, 0.0979021,  0.11101399, 0.125,      0.13986014, 0.15297203,
 0.16783217, 0.18094406, 0.19493008, 0.20979021, 0.22377622, 0.23776224,
 0.25087413, 0.26573426, 0.27972028, 0.28671327]
plt.plot(drpt_se,drpt_un, 'bo-', label="DRPT (6.5)")



plt.xlabel("seen_accuracy", font = new_font)
plt.ylabel("unseen_accuracy", font = new_font)
plt.title('C-GQA', font = new_font)
plt.legend(prop = new_font)   #打上标签
plt.savefig('demos/AUC-CGQA.pdf', dpi=300)
